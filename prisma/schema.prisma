// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Post {
  id            String   @id @default(cuid())
  title         String
  slug          String   @unique
  excerpt       String
  content       String   @db.Text
  category      String
  date          DateTime @default(now())
  readTime      String
  imageUrl      String
  authorName    String
  authorRole    String
  authorAvatar  String
  authorEmail   String
  authorBio     String
  likes         Int      @default(0)
  commentsCount Int      @default(0)
  
  // JSON fields for optional info (Book, Project, Thought, Writing)
  bookInfo      Json?
  projectInfo   Json?
  thoughtInfo   Json?
  writingInfo   Json?

  published     Boolean  @default(false)

  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model Comment {
  id            String   @id @default(cuid())
  postId        String
  authorName    String
  authorAvatar  String
  date          DateTime @default(now())
  text          String   @db.Text
  likes         Int      @default(0)
  isAuthor      Boolean  @default(false)
  
  // Self-relation for replies
  parentId      String?
  parent        Comment?  @relation("Replies", fields: [parentId], references: [id])
  replies       Comment[] @relation("Replies")

  createdAt     DateTime @default(now())
}
